% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/workflow.R
\name{speech_to_summary_workflow}
\alias{speech_to_summary_workflow}
\title{Full Speech-To-Summary Workflow Execution}
\usage{
speech_to_summary_workflow(
  target_dir = getwd(),
  source_audio = list.files(target_dir, pattern = ".*\\\\.(wav|mp\\\\d)$", full.names =
    TRUE)[1],
  split_audio = TRUE,
  split_audio_duration = 40,
  stt_audio_dir = file.path(target_dir, "audio_to_transcribe"),
  overwrite_stt_audio = FALSE,
  transcription_output_dir = file.path(target_dir, "transcription_output_data"),
  stt_output_dir = lifecycle::deprecated(),
  stt_model = getOption("minutemaker_stt_model"),
  stt_initial_prompt = NULL,
  stt_language = "en",
  extra_stt_args = NULL,
  overwrite_transcription_files = FALSE,
  enable_llm_correction = TRUE,
  transcript_file = file.path(target_dir, "transcript.csv"),
  event_start_time = getOption("minutemaker_event_start_time"),
  overwrite_transcript = FALSE,
  external_transcript = list.files(target_dir, pattern = "\\\\.(vtt|srt|docx)$",
    ignore.case = TRUE, full.names = TRUE)[1],
  import_diarization = TRUE,
  chat_file = list.files(target_dir, pattern = "Chat.*\\\\.txt$", ignore.case = TRUE,
    full.names = TRUE)[1],
  chat_format = "webex",
  generate_context = TRUE,
  use_agenda = c("ask", "yes", "no"),
  agenda_file = file.path(target_dir, "agenda.R"),
  expected_agenda = NULL,
  agenda_generation_window_size = 3600,
  extra_agenda_generation_args = NULL,
  multipart_summary = TRUE,
  event_description = NULL,
  audience = "An audience with understanding of the topic",
  vocabulary = NULL,
  consider_diarization = TRUE,
  summary_structure = get_prompts("summary_structure"),
  extra_diarization_instructions = NULL,
  extra_output_instructions = NULL,
  llm_provider = getOption("llmr_llm_provider"),
  extra_summarise_args = NULL,
  summarization_window_size = 15,
  summarization_output_length = if (isTRUE(multipart_summary)) 1 else 3,
  summarization_method = c("simple", "rolling"),
  summarization_output_file = file.path(target_dir, "event_summary.R"),
  overwrite_summary_tree = FALSE,
  formatted_output_file = file.path(target_dir, "event_summary.txt"),
  overwrite_formatted_output = FALSE
)
}
\arguments{
\item{target_dir}{A path to the folder where the summarisation process will
take place. All the intermediate and output files will be stored and looked
for here. It allows encapsulating a single summarisation task from start to
end.}

\item{source_audio}{A path to an audio file in wav or mp3/4 format. If
\code{split_audio} is TRUE, it will be split into multiple files which will be
place into the \code{stt_audio_dir} folder. See \code{split_audio} for more details.}

\item{split_audio}{A boolean indicating whether the audio file should be
split into multiple files. Some models, like "Whisper" based ones, can
process files only up to 25 MB. See \code{split_audio} for more details.}

\item{split_audio_duration}{The duration of each split audio file in minutes.
20 minutes equate to more or less 7-8 MB. See \code{split_audio} for more
details.}

\item{stt_audio_dir}{A string with the path to the folder where the audio
files to transcribe will be stored. See \code{split_audio} and
\code{perform_speech_to_text} for more details. The files in this folder will be
used as input for the speech-to-text model, so you can manually add audio
files to transcribe directly here.}

\item{overwrite_stt_audio}{A boolean indicating whether the audio files to
transcribe should be overwritten if they already exist.}

\item{transcription_output_dir}{A string with the path to the folder where
the JSON files generated by the speech-to-text model or an external
transcript will be stored. See \code{perform_speech_to_text} and
\code{use_transcript_input} for more details.}

\item{stt_output_dir}{Deprecated. Use \code{transcription_output_dir}.}

\item{stt_model}{A string indicating the speech-to-text model to use. See
\code{perform_speech_to_text} for more details.}

\item{stt_initial_prompt}{A string with the path to a file containing the
initial prompt to be used by the speech-to-text model. See
\code{perform_speech_to_text} for more details.}

\item{stt_language}{A string indicating the language of the audio file. See
\code{perform_speech_to_text} for more details.}

\item{extra_stt_args}{A list containing extra arguments to be passed to the
stt model function. See \code{perform_speech_to_text} for more details.}

\item{overwrite_transcription_files}{A boolean indicating whether existing
transcription JSON files should be overwritten. See
\code{perform_speech_to_text} and \code{use_transcript_input} for more details.}

\item{enable_llm_correction}{A boolean indicating whether to apply LLM-based
correction to the transcript.}

\item{transcript_file}{A path to the output file where the transcript will be
written.}

\item{event_start_time}{The start time of the event in the HH:MM(:SS)( AM/PM)
format. Will be used to add the actual clock time to the transcript
segments. If NULL, the clock time will not be added. See
\code{parse_transcript_json()} for more details.}

\item{overwrite_transcript}{A boolean indicating whether the transcript
output file should be overwritten if it already exists.}

\item{external_transcript}{A string with the path to the transcript file to
be used instead of performing speech-to-text. It will be picked up
automatically if a .vtt, .srt or .docx file is available in the target
directory. Pass NULL or NA to disable the automatic importation of
transcript files. See \code{import_transcript_from_file} for more details.}

\item{import_diarization}{A boolean indicating whether the speaker should be
imported from the external transcript, if present. See
\code{import_transcript_from_file} for more details.}

\item{chat_file}{A string with the path to a file containing the chat data.
It will be picked up automatically if a file with "Chat" in its name is
available in the target directory. Pass NULL or NA to disable the automatic
chat file importation. See \code{add_chat_transcript} for more details. Note
that \code{event_start_time} must be set if \code{chat_file} is not NULL.}

\item{chat_format}{A string indicating the online meeting platform used to
generate the chat file. See \code{add_chat_transcript} for more details.}

\item{generate_context}{A logical value indicating whether to generate
meeting context from documentation materials and transcripts before running
the workflow. When TRUE, analyzes materials in the 'documentation' folder
to automatically extract: expected agenda, event description, audience
info, domain vocabulary, and STT initial prompts. This significantly
improves summarization quality by providing domain-specific context to the
LLMs. Generated context takes precedence over manually provided parameters}

\item{use_agenda}{A string indicating whether to use an agenda for
summarization. Possible values are "ask" (interactive prompting), "yes"
(use or generate agenda), or "no" (don't use an agenda).
Possible values are "ask" (interactive prompting), "yes" (use or generate
agenda), or "no" (don't use an agenda).}

\item{agenda_file}{The path to an agenda file. If use_agenda="yes" and this
file exists, it will be used; otherwise a new agenda will be generated and
saved to this path.}

\item{expected_agenda}{A character string. Only used if a new agenda is being
generated. This string will be used to guide the LLM while generating the
agenda. See \code{infer_agenda_from_transcript} for more details.}

\item{agenda_generation_window_size}{The size of the window in seconds to
analyze at once when generating the agenda. See
\code{infer_agenda_from_transcript} for more details.}

\item{extra_agenda_generation_args}{Additional arguments passed to the
\code{infer_agenda_from_transcript} function. See \code{infer_agenda_from_transcript}
for more details. Note that the \code{diarization_instructions} argument for
this function will be taken from the \code{extra_agenda_generation_args}
argument.}

\item{multipart_summary}{If TRUE and an agenda is being used, summarisation
will be done in parts, one for each agenda element using the
\code{summarise_full_meeting} function. If FALSE, or if use_agenda="no",
summarization will be done in one go using the \code{summarise_transcript}
function. See the respective functions for more details.}

\item{event_description}{A string containing a description of the meeting.
See \code{summarise_transcript} for more details.}

\item{audience}{A string containing a description of the audience of the
meeting and what to focus on in the summary. See \code{summarise_transcript} for
more details.}

\item{vocabulary}{A character vector of specific vocabulary words, names,
definitions, to help the LLM recognise misspellings and abbreviations. See
\code{summarise_transcript} for more details.}

\item{consider_diarization}{A logical indicating whether the summarisation
should take into account the diarization of the transcript. See
\code{summarise_transcript} for more details.}

\item{summary_structure, extra_diarization_instructions, extra_output_instructions}{Specific instructions necessary to build the summarisation prompt. See
\code{summarise_transcript} for more details and run \code{get_prompts()} to see the
defaults. See \code{summarise_transcript} for more details.}

\item{llm_provider}{A string indicating the LLM provider to use for the
summarization. See \code{summarise_transcript} for more details.}

\item{extra_summarise_args}{Additional arguments passed to the
\code{llmR::prompt_llm} function. See \code{summarise_transcript} for more details.}

\item{summarization_window_size}{The size of the summarization window in
minutes if the "rolling" method is used. See \code{summarise_transcript} for
more details.}

\item{summarization_output_length}{An indication to the LLM regarding the
length of the output in pages. See \code{summarise_transcript} for more details.}

\item{summarization_method}{A string indicating the summarization method to
use. See \code{summarise_full_meeting} for more details.}

\item{summarization_output_file}{A string with the path to the output file
where the summary tree will be written. Should be a .R file. See
\code{summarise_full_meeting} for more details.}

\item{overwrite_summary_tree}{A boolean indicating whether the summary tree
output file should be overwritten if it already exists.}

\item{formatted_output_file}{A string with the path to the output file where
the formatted summary will be written.}

\item{overwrite_formatted_output}{A boolean indicating whether the formatted
summary output file should be overwritten if it already exists.}
}
\value{
A list containing the transcript data, the summary tree and the
formatted summary.
}
\description{
This function executes the full speech-to-summary workflow, from the
transcription of the audio recording to the generation of the summary tree,
to the formatting of the summary tree into a human-readable text.
}
